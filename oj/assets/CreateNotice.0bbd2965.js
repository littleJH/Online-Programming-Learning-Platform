import{m as e,bI as t,_ as a,j as s,a as r,l as o}from"./index.5c064301.js";import{s as i}from"./style.module.cb8cfc2a.js";import{T as c}from"./TextEditor.53774050.js";import{a as n,c as l}from"./noticeboard.0189f0d2.js";import{F as d}from"./index.0c9dd83b.js";import{I as m}from"./index.7d75d2c2.js";import{M as p}from"./index.6891d53f.js";import{R as u}from"./index.4071f4af.js";import"./index.4cc837d4.js";import"./context.aa52cc0c.js";import"./row.e491f7a6.js";import"./useLocale.07149357.js";import"./index.4e624168.js";import"./BaseInput.01760c9b.js";import"./ActionButton.76c967e9.js";import"./useClosable.e9e9bb76.js";import"./fade.9766c3a1.js";import"./PurePanel.bec90387.js";const f=()=>{const f=e.useNavTo(),[j,x]=t(),h=j.get("id"),[y]=d.useForm(),[b,F]=a.exports.useState(""),[v,C]=a.exports.useState(!1),[I,T]=a.exports.useState(),g=a.exports.useRef(null);a.exports.useEffect((()=>{h&&k()}),[h]);const k=async()=>{if(h)try{const e=(await n(h)).data.data.notice;F(e.content),y.setFieldsValue({title:e.title,content:e.content})}catch{}};return s("div",{className:i.noticeCreation,children:[s(d,{form:y,name:"noticeForm",layout:"vertical",scrollToFirstError:!0,initialValues:{auto_update:!0,auto_pass:!1,pass_re:!1},children:[r(d.Item,{name:"title",label:"标题：",rules:[{required:!0}],children:r(m,{ref:g})}),r(d.Item,{name:"content",label:"描述",rules:[{required:!0}],children:r(c,{value:b,mode:"markdown",htmlChange:e=>{F(e),y.setFieldValue("content","<p><br></p>"===e||""===e?void 0:e)}})})]}),r("div",{className:"text-center",children:r(o,{type:"primary",style:{margin:"1rem 0"},onClick:()=>{y.validateFields().then((async e=>{try{const t=(await l(e)).data;T({status:200===t.code?"success":"error",title:"创建"+(200===t.code?"成功":"失败"),subTitle:200===t.code?"":t.msg,extra:200===t.code?[r(o,{type:"primary",onClick:()=>f(`/community/notice/${t.data.notice.id}`),children:"查看详情"},"detail"),r(o,{type:"primary",onClick:()=>{x([]),y.resetFields(),C(!1),F("")},children:"继续创建"},"next")]:null}),C(!0)}catch{}})).catch((e=>{}))},children:"发布"})}),r(p,{open:v,footer:null,onCancel:()=>C(!1),style:{translate:"0 50%"},children:r(u,{...I})})]})};export{f as default};

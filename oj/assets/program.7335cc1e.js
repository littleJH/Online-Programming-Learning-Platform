import{L as e,F as a,g as t,a as s,c as o,b as n}from"./chatGpt.0470686f.js";import{cc as i,_ as l,bM as r,e as c,bP as d,cd as h,ch as m,t as f,d as p,n as g,j as u,F as x,a as y,S as C,l as v,M as b,al as k,q as w,cf as S,bN as j,bl as N,bG as L,c as z,aZ as M}from"./index.5c064301.js";import{o as R,l as H,a as O}from"./LanguageList.5e03f3ce.js";import{C as V}from"./CodeEditorConfig.c1285810.js";import{H as _}from"./Highlight.c2b7293d.js";import{s as E}from"./problem.1496b552.js";import{r as G}from"./recordStates.a45efd0a.js";import{S as P}from"./index.a45f76a6.js";import{D as T}from"./index.699f9875.js";import{M as $}from"./index.6891d53f.js";import{R as D}from"./index.4071f4af.js";import{S as F}from"./index.05a8036e.js";import{S as J}from"./SwapRightOutlined.64619f65.js";const W=z=>{var M;const{height:W,value:q,className:B,codeChange:I,oj:U,onLanguageChange:Y}=z,Z=e(),{id:A=""}=i(),K=l.exports.useRef(),[Q,X]=l.exports.useState(!1),[ee,ae]=l.exports.useState(!1),[te,se]=l.exports.useState(!1),[oe,ne]=l.exports.useState(""),[ie,le]=r(c),[re,ce]=r(d),[de,he]=r(h),[me,fe]=l.exports.useState([de,de]),[pe,ge]=l.exports.useState(""),[ue,xe]=l.exports.useState(),[ye,Ce]=r(m),[ve,be]=l.exports.useState(!1),{token:ke}=f.useToken(),we=p(g),[Se,je]=l.exports.useState(!1);l.exports.useEffect((()=>{}),[de]);const Ne=l.exports.useMemo((()=>R[`${null==U?void 0:U.toLowerCase()}_languageList`]||R.defaultLanguageList),[U]),Le=e=>{if(!K.current||!Z)return;const a=K.current,t=a.getSelection(),s=null==t?void 0:t.endLineNumber,o=a.getModel(),n=null==o?void 0:o.getLineCount(),i=s?s+1:n?n-1:1;null==o||o.applyEdits([{range:new Z.Range(i,1,i,1),text:e}])};return u(x,{children:[u("div",{style:{height:`${W}px`},children:[u("div",{className:"h-12 p-2 flex items-center",style:{backgroundColor:ke.colorPrimaryBg},children:[y(P,{style:{minWidth:"max-content"},dropdownStyle:{minWidth:"max-content"},variant:"borderless",defaultValue:de,options:Ne,onChange:e=>{he(e),Y&&Y(e)}}),y("div",{className:"grow"}),u(C,{children:[y(v,{type:"text",className:"flex items-center",icon:y(b,{href:"chexiao",size:2}),onClick:()=>{}}),y(v,{type:"text",className:"flex items-center",icon:y(b,{href:"huifu",size:2})}),y(T,{disabled:ve,arrow:!0,menu:{items:[{key:"note",label:"生成注释",onClick:()=>{(async()=>{try{be(!0);const e=(await t(de,q)).data.data.res;I(e)}finally{be(!1)}})()}},{key:"code",label:"生成代码",onClick:()=>{(async()=>{if(oe)try{be(!0);const e=(await s(de,oe)).data.data.res;Le(e)}finally{be(!1)}else we&&we.warning({message:"请选择源文本",duration:1})})()}},{key:"exchange",label:"代码转换",onClick:()=>{ae(!0)}},{key:"comment",label:"代码编写意见",onClick:()=>{(async()=>{try{be(!0);const e=await E(A);if(200===e.data.code){const a={problem:e.data.data.problem,code:q},t=(await n(de,a)).data.data;xe(t),se(!0)}}finally{be(!1)}})()}}]},children:y(v,{icon:ve?y(k,{}):y(b,{href:"chatGPT",size:2}),type:"text",className:"flex items-center",disabled:ve})}),y(v,{icon:y(b,{href:"#icon-"+("light"===ye?"light":"vs-dark"),size:2,color:""+("light"===ye?"#fff":"#000")}),type:"text",className:"flex items-center",onClick:()=>{Ce((e=>"vs-dark"===e?"light":"vs-dark"))}}),y(v,{icon:y(b,{href:"#icon-setting",size:2}),type:"text",className:"flex items-center",onClick:()=>X(!0)})]})]}),y(a,{value:q,height:W-42+"px",width:"100%",className:`${B} bg-white`,language:w.includes(de)?"cpp":H.get(de),theme:ye,loading:y(S,{}),onChange:e=>I(e),options:re,onMount:(e,a)=>{K.current=e,e.onDidChangeCursorSelection((a=>{var t;const s=null==(t=e.getModel())?void 0:t.getValueInRange(a.selection);s&&ne(s)}))}})]}),y($,{title:y("p",{children:"代码编辑器配置"}),open:Q,onCancel:()=>X(!1),afterClose:()=>(()=>{let e={...ie,monaco_options:JSON.stringify(re)};de&&(e={...e,language:de}),ye&&(e={...e,monaco_theme:ye}),j(JSON.stringify(e)).then((async e=>{if(200===e.data.code){const e=await N();le(e.data.data.user)}}))})(),footer:[],centered:!0,children:y("div",{style:{maxHeight:"50vh",overflowY:"scroll"},children:y(V,{monacoOptions:re,setMonacoOptions:ce})})}),y($,{title:"代码转换",width:"80vw",open:ee,onCancel:()=>{ae(!1)},afterClose:()=>{ge("")},maskClosable:!1,footer:[y(v,{type:"primary",onClick:()=>ae(!1),children:"取消"},1),y(v,{type:"primary",onClick:async()=>{try{be(!0);const e=(await o(me[0],me[1],q)).data.data.res;if(ge(e),e){L.copyToClipboard(e)&&we&&we.success({message:"已将转换结果复制到剪切板",duration:1})}}finally{be(!1)}},loading:ve,children:"开始转换"},2)],centered:!0,children:u("div",{children:[u(C,{size:"large",align:"center",className:"justify-center flex",children:[y(P,{size:"large",options:O,defaultValue:de,onChange:e=>fe((a=>[e,a[1]]))}),u("span",{className:"flex flex-col",children:[y(J,{}),y(J,{})]}),y(P,{size:"large",options:O,defaultValue:de,onChange:e=>fe((a=>[a[0],e]))})]}),u("div",{style:{maxHeight:"400px",overflow:"scroll"},children:[y("h4",{children:"源代码"}),y(_,{code:q})]}),pe&&u("div",{style:{maxHeight:"400px",overflow:"scroll"},children:[y("h4",{children:"目标代码"}),y(_,{code:pe})]})]})}),u($,{title:"代码编写意见",open:te,onCancel:()=>se(!1),footer:[],width:"80vw",centered:!0,children:[u("div",{children:[y(D,{style:{padding:"2rem 1rem"},title:(null==ue?void 0:ue.res)||"",status:null==(M=G.find((e=>e.value===(null==ue?void 0:ue.res))))?void 0:M.state}),y(_,{code:(null==ue?void 0:ue.description)||""})]}),u("div",{children:[y(F,{checkedChildren:"收起",unCheckedChildren:"查看源代码",defaultChecked:!1,onChange:e=>je(e)}),Se&&y(_,{code:q})]})]})]})},q=z({baseURL:"program"}),B=e=>q.post("/create",e,M());export{W as C,B as c};

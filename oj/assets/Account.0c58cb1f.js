import{_ as e,a as s,A as a,m as l,bM as r,e as t,d as i,i as o,j as n,l as d,D as c,S as m,bN as u,bS as h,bT as p,bn as v}from"./index.5c064301.js";import{F as f}from"./FindPass.16c8f600.js";import{s as b}from"./style.module.b5b5c35b.js";import{F as g}from"./index.0c9dd83b.js";import{D as y}from"./index.972659d0.js";import{M as j}from"./index.6891d53f.js";import{I as x}from"./index.7d75d2c2.js";import{R as w,C}from"./row.e491f7a6.js";import"./context.aa52cc0c.js";import"./useLocale.07149357.js";import"./ActionButton.76c967e9.js";import"./useClosable.e9e9bb76.js";import"./fade.9766c3a1.js";import"./PurePanel.bec90387.js";import"./index.4e624168.js";import"./BaseInput.01760c9b.js";const P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};var I=function(e,l){return s(a,{...e,ref:l,icon:P})};const F=e.exports.forwardRef(I),N=()=>{const a=l.useNavTo(),[P,I]=r(t),[N]=g.useForm(),[k]=g.useForm(),[S,z]=e.exports.useState(!1),[M,L]=e.exports.useState(!1),[_,D]=e.exports.useState(!1),[E,B]=e.exports.useState(!1),{count:V,start:$}=l.useCountdown(60,(()=>{B(!1)})),A=i(o);return n("div",{className:b.account,children:[n("div",{className:"flex items-center",children:[s("h3",{className:"label grow",children:"账号信息"}),s(d,{type:"dashed",onClick:()=>{localStorage.removeItem("token"),I(null),a("/login")},children:"退出登录"})]}),s(c,{}),n(y,{column:1,layout:A?"vertical":"horizontal",children:[s(y.Item,{label:"UID",children:null==P?void 0:P.id}),s(y.Item,{label:"邮箱",children:n("div",{children:[s("span",{children:null==P?void 0:P.email}),s("span",{className:"mx-4",children:s(F,{className:"hover:cursor-pointer",style:{color:"red"},onClick:()=>z(!0)})})]})}),s(y.Item,{label:"密码",children:n(m,{children:[s(d,{type:"dashed",size:"small",onClick:()=>L(!0),children:"更改密码"}),s(d,{type:"dashed",size:"small",onClick:()=>D(!0),children:"找回密码"})]})})]}),s("h3",{className:"label",children:"实名认证"}),s(c,{}),s("h3",{className:"label",children:"关联第三方账号"}),s(c,{}),s("div",{className:"text-center"}),s(j,{title:"更改邮箱",open:S,onCancel:()=>z(!1),style:{translate:"0 50%"},footer:[s(d,{type:"primary",onClick:()=>{k.validateFields().then((e=>{const s={name:null==P?void 0:P.name,email:e.email,blog:null==P?void 0:P.blog,sex:null==P?void 0:P.sex,address:null==P?void 0:P.address,icon:null==P?void 0:P.icon,res_long:null==P?void 0:P.res_long,res_short:null==P?void 0:P.res_short,verify:e.verify};u(JSON.stringify(s)).then((e=>{if(200===e.data.code){const s=e.data.data.user;I(s),h.success({message:"邮箱更改成功",description:`新邮箱为：${s.email}`}),z(!1)}else h.error({message:e.data.msg})}))}))},children:"确定"},"updateEmail")],children:n(g,{layout:"vertical",form:k,children:[s(g.Item,{label:"原邮箱：",children:s(x,{disabled:!0,defaultValue:null==P?void 0:P.email})}),s(g.Item,{name:"email",label:"新邮箱：",rules:[{type:"email",message:"邮箱格式错误"}],children:s(x,{})}),n(w,{gutter:8,children:[s(C,{span:8,children:s(g.Item,{name:"verify",label:"验证码：",rules:[{type:"string",len:6,message:"验证码格式错误"}],children:s(x,{})})}),s(C,{span:4,children:s(g.Item,{label:" ",children:n(d,{disabled:E,onClick:()=>{if(!P)return;(e=>{v(e).then((s=>{200===s.data.code&&($(),B(!0),h.success({message:"验证码获取成功",description:`验证码已发送至您的邮箱 ${e}`}))}))})(k.getFieldValue("email"))},children:[E&&`${V} 秒后重新获取`,!E&&"获取验证码"]})})})]})]})}),s(j,{title:"更改密码",open:M,onCancel:()=>L(!1),style:{translate:"0 50%"},footer:[s(d,{type:"primary",onClick:()=>{N.validateFields().then((e=>{const s=new FormData;s.append("first",e.first),s.append("second",e.second),p(s).then((e=>{200===e.data.code?(h.success({message:"密码更改成功"}),L(!1)):h.error({message:e.data.msg})}))}))},children:"确定"},"updatePassword")],children:n(g,{form:N,layout:"vertical",children:[s(g.Item,{name:"first",label:"旧密码：",rules:[({})=>({validator:(e,s)=>s?Promise.resolve():Promise.reject(new Error("请输入旧密码"))})],children:s(x.Password,{allowClear:!0})}),s(g.Item,{name:"second",label:"新密码：",rules:[{type:"string",min:6,message:"密码长度最少为6位"},({})=>({validator:(e,s)=>s?Promise.resolve():Promise.reject(new Error("请输入旧密码"))})],children:s(x.Password,{allowClear:!0})}),s(g.Item,{name:"confirm",label:"确认新密码：",rules:[{type:"string",min:6,message:"密码长度最少为6位"},({getFieldValue:e})=>({validator:(s,a)=>a&&e("second")!==a?Promise.reject(new Error("密码不一致")):Promise.resolve()})],children:s(x.Password,{allowClear:!0})})]})}),s(f,{openFindPwModal:_,setOpenFindPwModal:D})]})};export{N as default};

import{m as t,R as e,ck as s,_ as o,bG as a,bF as r,a as i,d,cb as m,cj as c,t as n}from"./index.5c064301.js";import{L as l}from"./LoadMoreList.3dfd533d.js";import{s as p}from"./style.module.a7bf0b2a.js";import{g as u,a as j,b as f,c as b}from"./post.12635ac3.js";import{G as y}from"./GeneralCard.8772c459.js";import{R as k}from"./Readonly.a9ebc692.js";import{C as x}from"./index.9225dd62.js";import"./Skeleton.ed2cb458.js";import"./index.0ec24622.js";import"./Pagination.855f4d50.js";import"./context.aa52cc0c.js";import"./index.a45f76a6.js";import"./List.6e377c69.js";import"./PurePanel.bec90387.js";import"./index.4e624168.js";import"./useLocale.07149357.js";import"./CheckOutlined.363c4795.js";import"./row.e491f7a6.js";import"./index.bad11826.js";import"./ActionButton.76c967e9.js";import"./MyTag.a4f82d92.js";import"./useClosable.e9e9bb76.js";import"./style.module.dc2582af.js";import"./MyAvatar.22457dcc.js";import"./index.4cc837d4.js";import"./PlusOutlined.787b1bb7.js";import"./Dropdown.acaf0b68.js";const h=d=>{const{postProps:m,onClick:c,mode:n="default",showReply:l,style:p}=d,f=t.useNavTo(),b=e(s),[h,g]=o.exports.useState(m),P=o.exports.useMemo((()=>{const{num:t,unit:e}=a.getTimeAgo(h.created_at);return`${t}${e}前`}),[h]);o.exports.useEffect((()=>{w()}),[]);const w=async()=>{try{const t={...m},e=await Promise.all([u(m.id),j(m.id,"true"),r(m.user_id)]);t.liked=e[0].data.data.like,t.likeNum=e[1].data.data.total,t.user=e[2].data.data.user,g(t)}catch{}};return i(x,{style:p,hoverable:!0,size:"small",children:i(y,{user:null==h?void 0:h.user,liked:{count:h.likeNum,isLiked:h.liked},title:h.title,content:i(k,{html:h.content,style:{margin:"0.5rem"},borderd:!0}),ago:P,onClick:()=>{b(h),f(`/community/post/${h.id}`)}})})},g=()=>{t.useNavTo();const e=d(m),s=d(c),[r,u]=o.exports.useState([]),[j,y]=o.exports.useState(0),{token:k}=n.useToken(),x=o.exports.useMemo((()=>(u([]),async(t,s,o)=>{try{const r=[],i=(await f(a.getPathArray(e)[1],t,s)).data.data;for(let t of i.posts)r.push((await b(t.Member)).data.data.post);u((t=>t?[...t,...r]:r)),y(i.total),o()}catch{}})),[s]);return i("div",{className:p.post,children:i(l,{dataSource:r,total:j,fetchFn:x,split:!1,itemRender:t=>i(h,{style:{backgroundColor:k.colorPrimaryBg,marginBottom:"2rem"},postProps:t,showReply:!0})})})};export{g as default};

import{_ as t,a as e,m as a,d as n,e as o,n as i,bG as r,bF as s,j as l,S as d,F as u,l as c,cn as p}from"./index.5c064301.js";import{R as h}from"./Readonly.a9ebc692.js";import{a as g}from"./competitionStore.2ce7a0b2.js";import{C as f}from"./CompetitionTypeLabel.59429231.js";import{M as y}from"./MyTag.a4f82d92.js";import{_ as m,bi as v,B as x,aG as _,u as b,bs as S,bt as I,t as L,bu as w,W as M,bv as D,bw as T,aS as N,aU as A,e as E,b9 as C,b6 as V,bb as R,b3 as k,r as P,i as z,a_ as B,am as j,an as G,bx as O,N as F,by as X,bz as Y,aF as Z,bA as U,a8 as H,bB as W,T as q,m as K,a as J,J as $,aP as Q,ao as tt,bC as et,bD as at,bE as nt,bF as ot,bG as it,bH as rt,bI as st,l as lt,bf as dt,x as ut,bJ as ct,bK as pt,bL as ht,aW as gt,aC as ft,aZ as yt,ac as mt,b1 as vt,h as xt,M as _t,bM as bt,bN as St,aM as It,bO as Lt,A as wt,bP as Mt,bQ as Dt,bR as Tt,ak as Nt,bS as At,bT as Et,aN as Ct,bU as Vt,Z as Rt,bp as kt,bq as Pt,br as zt,bo as Bt}from"./installCanvasRenderer.8eafef91.js";import{D as jt}from"./index.972659d0.js";import{M as Gt}from"./index.6891d53f.js";import"./index.4cc837d4.js";import"./useClosable.e9e9bb76.js";import"./context.aa52cc0c.js";import"./ActionButton.76c967e9.js";import"./useLocale.07149357.js";import"./fade.9766c3a1.js";import"./PurePanel.bec90387.js";var Ot=b;function Ft(t){var e=t.seriesModel;return e?e.coordinateSystem:null}const Xt=function(t){function e(e){var a=t.call(this)||this;return a.type="view",a.dimensions=["x","y"],a._roamTransformable=new v,a._rawTransformable=new v,a.name=e,a}return m(e,t),e.prototype.setBoundingRect=function(t,e,a,n){return this._rect=new x(t,e,a,n),this._rect},e.prototype.getBoundingRect=function(){return this._rect},e.prototype.setViewRect=function(t,e,a,n){this._transformTo(t,e,a,n),this._viewRect=new x(t,e,a,n)},e.prototype._transformTo=function(t,e,a,n){var o=this.getBoundingRect(),i=this._rawTransformable;i.transform=o.calculateTransform(new x(t,e,a,n));var r=i.parent;i.parent=null,i.decomposeTransform(),i.parent=r,this._updateTransform()},e.prototype.setCenter=function(t,e){t&&(this._center=[_(t[0],e.getWidth()),_(t[1],e.getHeight())],this._updateCenterAndZoom())},e.prototype.setZoom=function(t){t=t||1;var e=this.zoomLimit;e&&(null!=e.max&&(t=Math.min(e.max,t)),null!=e.min&&(t=Math.max(e.min,t))),this._zoom=t,this._updateCenterAndZoom()},e.prototype.getDefaultCenter=function(){var t=this.getBoundingRect();return[t.x+t.width/2,t.y+t.height/2]},e.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},e.prototype.getZoom=function(){return this._zoom||1},e.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},e.prototype._updateCenterAndZoom=function(){var t=this._rawTransformable.getLocalTransform(),e=this._roamTransformable,a=this.getDefaultCenter(),n=this.getCenter(),o=this.getZoom();n=b([],n,t),a=b([],a,t),e.originX=n[0],e.originY=n[1],e.x=a[0]-n[0],e.y=a[1]-n[1],e.scaleX=e.scaleY=o,this._updateTransform()},e.prototype._updateTransform=function(){var t=this._roamTransformable,e=this._rawTransformable;e.parent=t,t.updateTransform(),e.updateTransform(),S(this.transform||(this.transform=[]),e.transform||I()),this._rawTransform=e.getLocalTransform(),this.invTransform=this.invTransform||[],L(this.invTransform,this.transform),this.decomposeTransform()},e.prototype.getTransformInfo=function(){var t=this._rawTransformable,e=this._roamTransformable,a=new v;return a.transform=e.transform,a.decomposeTransform(),{roam:{x:a.x,y:a.y,scaleX:a.scaleX,scaleY:a.scaleY},raw:{x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleY}}},e.prototype.getViewRect=function(){return this._viewRect},e.prototype.getViewRectAfterRoam=function(){var t=this.getBoundingRect().clone();return t.applyTransform(this.transform),t},e.prototype.dataToPoint=function(t,e,a){var n=e?this._rawTransform:this.transform;return a=a||[],n?Ot(a,t,n):w(a,t)},e.prototype.pointToData=function(t){var e=this.invTransform;return e?Ot([],t,e):[t[0],t[1]]},e.prototype.convertToPixel=function(t,e,a){var n=Ft(e);return n===this?n.dataToPoint(a):null},e.prototype.convertFromPixel=function(t,e,a){var n=Ft(e);return n===this?n.pointToData(a):null},e.prototype.containPoint=function(t){return this.getViewRectAfterRoam().contain(t[0],t[1])},e.dimensions=["x","y"],e}(v);function Yt(t,e){return t.pointToProjected?t.pointToProjected(e):t.pointToData(e)}var Zt=M.prototype,Ut=D.prototype,Ht=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1};function Wt(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1)}!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}m(e,t)}(Ht);const qt=function(t){function e(e){var a=t.call(this,e)||this;return a.type="ec-line",a}return m(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Ht},e.prototype.buildPath=function(t,e){Wt(e)?Zt.buildPath.call(this,t,e):Ut.buildPath.call(this,t,e)},e.prototype.pointAt=function(t){return Wt(this.shape)?Zt.pointAt.call(this,t):Ut.pointAt.call(this,t)},e.prototype.tangentAt=function(t){var e=this.shape,a=Wt(e)?[e.x2-e.x1,e.y2-e.y1]:Ut.tangentAt.call(this,t);return T(a,a)},e}(N);var Kt=["fromSymbol","toSymbol"];function Jt(t){return"_"+t+"Type"}function $t(t,e,a){var n=e.getItemVisual(a,t);if(!n||"none"===n)return n;var o=e.getItemVisual(a,t+"Size"),i=e.getItemVisual(a,t+"Rotate"),r=e.getItemVisual(a,t+"Offset"),s=e.getItemVisual(a,t+"KeepAspect"),l=X(o);return n+l+Y(r||0,l)+(i||"")+(s||"")}function Qt(t,e,a){var n=e.getItemVisual(a,t);if(n&&"none"!==n){var o=e.getItemVisual(a,t+"Size"),i=e.getItemVisual(a,t+"Rotate"),r=e.getItemVisual(a,t+"Offset"),s=e.getItemVisual(a,t+"KeepAspect"),l=X(o),d=Y(r||0,l),u=Z(n,-l[0]/2+d[0],-l[1]/2+d[1],l[0],l[1],null,s);return u.__specifiedRotation=null==i||isNaN(i)?void 0:+i*Math.PI/180||0,u.name=t,u}}function te(t,e){t.x1=e[0][0],t.y1=e[0][1],t.x2=e[1][0],t.y2=e[1][1],t.percent=1;var a=e[2];a?(t.cpx1=a[0],t.cpy1=a[1]):(t.cpx1=NaN,t.cpy1=NaN)}const ee=function(t){function e(e,a,n){var o=t.call(this)||this;return o._createLine(e,a,n),o}return m(e,t),e.prototype._createLine=function(t,e,a){var n=t.hostModel,o=function(t){var e=new qt({name:"line",subPixelOptimize:!0});return te(e.shape,t),e}(t.getItemLayout(e));o.shape.percent=0,A(o,{shape:{percent:1}},n,e),this.add(o),E(Kt,(function(a){var n=Qt(a,t,e);this.add(n),this[Jt(a)]=$t(a,t,e)}),this),this._updateCommonStl(t,e,a)},e.prototype.updateData=function(t,e,a){var n=t.hostModel,o=this.childOfName("line"),i=t.getItemLayout(e),r={shape:{}};te(r.shape,i),C(o,r,n,e),E(Kt,(function(a){var n=$t(a,t,e),o=Jt(a);if(this[o]!==n){this.remove(this.childOfName(a));var i=Qt(a,t,e);this.add(i)}this[o]=n}),this),this._updateCommonStl(t,e,a)},e.prototype.getLinePath=function(){return this.childAt(0)},e.prototype._updateCommonStl=function(t,e,a){var n=t.hostModel,o=this.childOfName("line"),i=a&&a.emphasisLineStyle,r=a&&a.blurLineStyle,s=a&&a.selectLineStyle,l=a&&a.labelStatesModels,d=a&&a.emphasisDisabled,u=a&&a.focus,c=a&&a.blurScope;if(!a||t.hasItemOption){var p=t.getItemModel(e),h=p.getModel("emphasis");i=h.getModel("lineStyle").getLineStyle(),r=p.getModel(["blur","lineStyle"]).getLineStyle(),s=p.getModel(["select","lineStyle"]).getLineStyle(),d=h.get("disabled"),u=h.get("focus"),c=h.get("blurScope"),l=V(p)}var g=t.getItemVisual(e,"style"),f=g.stroke;o.useStyle(g),o.style.fill=null,o.style.strokeNoScale=!0,o.ensureState("emphasis").style=i,o.ensureState("blur").style=r,o.ensureState("select").style=s,E(Kt,(function(t){var e=this.childOfName(t);if(e){e.setColor(f),e.style.opacity=g.opacity;for(var a=0;a<R.length;a++){var n=R[a],i=o.getState(n);if(i){var r=i.style||{},s=e.ensureState(n),l=s.style||(s.style={});null!=r.stroke&&(l[e.__isEmptyBrush?"stroke":"fill"]=r.stroke),null!=r.opacity&&(l.opacity=r.opacity)}}e.markRedraw()}}),this);var y=n.getRawValue(e);k(this,l,{labelDataIndex:e,labelFetcher:{getFormattedLabel:function(e,a){return n.getFormattedLabel(e,a,t.dataType)}},inheritColor:f||"#000",defaultOpacity:g.opacity,defaultText:(null==y?t.getName(e):isFinite(y)?P(y):y)+""});var m=this.getTextContent();if(m){var v=l.normal;m.__align=m.style.align,m.__verticalAlign=m.style.verticalAlign,m.__position=v.get("position")||"middle";var x=v.get("distance");z(x)||(x=[x,x]),m.__labelDistance=x}this.setTextConfig({position:null,local:!0,inside:!1}),B(this,u,c,d)},e.prototype.highlight=function(){j(this)},e.prototype.downplay=function(){G(this)},e.prototype.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e))},e.prototype.setLinePoints=function(t){var e=this.childOfName("line");te(e.shape,t),e.dirty()},e.prototype.beforeUpdate=function(){var t=this,e=t.childOfName("fromSymbol"),a=t.childOfName("toSymbol"),n=t.getTextContent();if(e||a||n&&!n.ignore){for(var o=1,i=this.parent;i;)i.scaleX&&(o/=i.scaleX),i=i.parent;var r=t.childOfName("line");if(this.__dirty||r.__dirty){var s=r.shape.percent,l=r.pointAt(0),d=r.pointAt(s),u=O([],d,l);if(T(u,u),e&&(e.setPosition(l),I(e,0),e.scaleX=e.scaleY=o*s,e.markRedraw()),a&&(a.setPosition(d),I(a,1),a.scaleX=a.scaleY=o*s,a.markRedraw()),n&&!n.ignore){n.x=n.y=0,n.originX=n.originY=0;var c=void 0,p=void 0,h=n.__labelDistance,g=h[0]*o,f=h[1]*o,y=s/2,m=r.tangentAt(y),v=[m[1],-m[0]],x=r.pointAt(y);v[1]>0&&(v[0]=-v[0],v[1]=-v[1]);var _=m[0]<0?-1:1;if("start"!==n.__position&&"end"!==n.__position){var b=-Math.atan2(m[1],m[0]);d[0]<l[0]&&(b=Math.PI+b),n.rotation=b}var S=void 0;switch(n.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":S=-f,p="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":S=f,p="top";break;default:S=0,p="middle"}switch(n.__position){case"end":n.x=u[0]*g+d[0],n.y=u[1]*f+d[1],c=u[0]>.8?"left":u[0]<-.8?"right":"center",p=u[1]>.8?"top":u[1]<-.8?"bottom":"middle";break;case"start":n.x=-u[0]*g+l[0],n.y=-u[1]*f+l[1],c=u[0]>.8?"right":u[0]<-.8?"left":"center",p=u[1]>.8?"bottom":u[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":n.x=g*_+l[0],n.y=l[1]+S,c=m[0]<0?"right":"left",n.originX=-g*_,n.originY=-S;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":n.x=x[0],n.y=x[1]+S,c="center",n.originY=-S;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":n.x=-g*_+d[0],n.y=d[1]+S,c=m[0]>=0?"right":"left",n.originX=g*_,n.originY=-S}n.scaleX=n.scaleY=o,n.setStyle({verticalAlign:n.__verticalAlign||p,align:n.__align||c})}}}function I(t,e){var a=t.__specifiedRotation;if(null==a){var n=r.tangentAt(e);t.attr("rotation",(1===e?-1:1)*Math.PI/2-Math.atan2(n[1],n[0]))}else t.attr("rotation",a)}},e}(F);function ae(t){var e=t.hostModel,a=e.getModel("emphasis");return{lineStyle:e.getModel("lineStyle").getLineStyle(),emphasisLineStyle:a.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:e.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:e.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:a.get("disabled"),blurScope:a.get("blurScope"),focus:a.get("focus"),labelStatesModels:V(e)}}function ne(t){return isNaN(t[0])||isNaN(t[1])}function oe(t){return t&&!ne(t[0])&&!ne(t[1])}const ie=function(){function t(t){this.group=new F,this._LineCtor=t||ee}return t.prototype.updateData=function(t){var e=this;this._progressiveEls=null;var a=this,n=a.group,o=a._lineData;a._lineData=t,o||n.removeAll();var i=ae(t);t.diff(o).add((function(a){e._doAdd(t,a,i)})).update((function(a,n){e._doUpdate(o,t,n,a,i)})).remove((function(t){n.remove(o.getItemGraphicEl(t))})).execute()},t.prototype.updateLayout=function(){var t=this._lineData;t&&t.eachItemGraphicEl((function(e,a){e.updateLayout(t,a)}),this)},t.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=ae(t),this._lineData=null,this.group.removeAll()},t.prototype.incrementalUpdate=function(t,e){function a(t){t.isGroup||function(t){return t.animators&&t.animators.length>0}(t)||(t.incremental=!0,t.ensureState("emphasis").hoverLayer=!0)}this._progressiveEls=[];for(var n=t.start;n<t.end;n++){if(oe(e.getItemLayout(n))){var o=new this._LineCtor(e,n,this._seriesScope);o.traverse(a),this.group.add(o),e.setItemGraphicEl(n,o),this._progressiveEls.push(o)}}},t.prototype.remove=function(){this.group.removeAll()},t.prototype.eachRendered=function(t){U(this._progressiveEls||this.group,t)},t.prototype._doAdd=function(t,e,a){if(oe(t.getItemLayout(e))){var n=new this._LineCtor(t,e,a);t.setItemGraphicEl(e,n),this.group.add(n)}},t.prototype._doUpdate=function(t,e,a,n,o){var i=t.getItemGraphicEl(a);oe(e.getItemLayout(n))?(i?i.updateData(e,n,o):i=new this._LineCtor(e,n,o),e.setItemGraphicEl(n,i),this.group.add(i)):this.group.remove(i)},t}();const re=function(){function t(t,e){this._getDataWithEncodedVisual=t,this._getRawData=e}return t.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},t.prototype.containName=function(t){return this._getRawData().indexOfName(t)>=0},t.prototype.indexOfName=function(t){return this._getDataWithEncodedVisual().indexOfName(t)},t.prototype.getItemVisual=function(t,e){return this._getDataWithEncodedVisual().getItemVisual(t,e)},t}();var se=K();function le(t,e){if(se(n=this).mainData===n){var a=q({},se(this).datas);a[this.dataType]=e,he(e,a,t)}else ge(e,this.dataType,se(this).mainData,t);var n;return e}function de(t,e){return t.struct&&t.struct.update(),e}function ue(t,e){return E(se(e).datas,(function(a,n){a!==e&&ge(a.cloneShallow(),n,e,t)})),e}function ce(t){var e=se(this).mainData;return null==t||null==e?e:se(e).datas[t]}function pe(){var t=se(this).mainData;return null==t?[{data:t}]:J($(se(t).datas),(function(e){return{type:e,data:se(t).datas[e]}}))}function he(t,e,a){se(t).datas={},E(e,(function(e,n){ge(e,n,t,a)}))}function ge(t,e,a,n){se(a).datas[e]=t,se(t).mainData=a,t.dataType=e,n.struct&&(t[n.structAttr]=n.struct,n.struct[n.datasAttr[e]]=t),t.getLinkedData=ce,t.getLinkedDataAll=pe}function fe(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.eachSeriesByType("graph",(function(t){var a=t.getCategoriesData(),n=t.getGraph().data,o=a.mapArray(a.getName);n.filterSelf((function(t){var a=n.getItemModel(t).getShallow("category");if(null!=a){Q(a)&&(a=o[a]);for(var i=0;i<e.length;i++)if(!e[i].isSelected(a))return!1}return!0}))}))}function ye(t){var e={};t.eachSeriesByType("graph",(function(t){var a=t.getCategoriesData(),n=t.getData(),o={};a.each((function(n){var i=a.getName(n);o["ec-"+i]=n;var r=a.getItemModel(n),s=r.getModel("itemStyle").getItemStyle();s.fill||(s.fill=t.getColorFromPalette(i,e)),a.setItemVisual(n,"style",s);for(var l=["symbol","symbolSize","symbolKeepAspect"],d=0;d<l.length;d++){var u=r.getShallow(l[d],!0);null!=u&&a.setItemVisual(n,l[d],u)}})),a.count()&&n.each((function(t){var e=n.getItemModel(t).getShallow("category");if(null!=e){tt(e)&&(e=o["ec-"+e]);var i=a.getItemVisual(e,"style"),r=n.ensureUniqueItemVisual(t,"style");q(r,i);for(var s=["symbol","symbolSize","symbolKeepAspect"],l=0;l<s.length;l++)n.setItemVisual(t,s[l],a.getItemVisual(e,s[l]))}}))}))}function me(t){return t instanceof Array||(t=[t,t]),t}function ve(t){t.eachSeriesByType("graph",(function(t){var e=t.getGraph(),a=t.getEdgeData(),n=me(t.get("edgeSymbol")),o=me(t.get("edgeSymbolSize"));a.setVisual("fromSymbol",n&&n[0]),a.setVisual("toSymbol",n&&n[1]),a.setVisual("fromSymbolSize",o&&o[0]),a.setVisual("toSymbolSize",o&&o[1]),a.setVisual("style",t.getModel("lineStyle").getLineStyle()),a.each((function(t){var n=a.getItemModel(t),o=e.getEdgeByIndex(t),i=me(n.getShallow("symbol",!0)),r=me(n.getShallow("symbolSize",!0)),s=n.getModel("lineStyle").getLineStyle(),l=a.ensureUniqueItemVisual(t,"style");switch(q(l,s),l.stroke){case"source":var d=o.node1.getVisual("style");l.stroke=d&&d.fill;break;case"target":d=o.node2.getVisual("style");l.stroke=d&&d.fill}i[0]&&o.setVisual("fromSymbol",i[0]),i[1]&&o.setVisual("toSymbol",i[1]),r[0]&&o.setVisual("fromSymbolSize",r[0]),r[1]&&o.setVisual("toSymbolSize",r[1])}))}))}var xe="--\x3e",_e=function(t){return t.get("autoCurveness")||null},be=function(t,e){var a=_e(t),n=20,o=[];if(Q(a))n=a;else if(z(a))return void(t.__curvenessList=a);e>n&&(n=e);var i=n%2?n+2:n+3;o=[];for(var r=0;r<i;r++)o.push((r%2?r+1:r)/10*(r%2?-1:1));t.__curvenessList=o},Se=function(t,e,a){var n=[t.id,t.dataIndex].join("."),o=[e.id,e.dataIndex].join(".");return[a.uid,n,o].join(xe)},Ie=function(t){var e=t.split(xe);return[e[0],e[2],e[1]].join(xe)},Le=function(t,e){var a=Se(t.node1,t.node2,e);return e.__edgeMap[a]},we=function(t,e){return Me(Se(t.node1,t.node2,e),e)+Me(Se(t.node2,t.node1,e),e)},Me=function(t,e){var a=e.__edgeMap;return a[t]?a[t].length:0};function De(t,e,a,n){var o=_e(e),i=z(o);if(!o)return null;var r=Le(t,e);if(!r)return null;for(var s=-1,l=0;l<r.length;l++)if(r[l]===a){s=l;break}var d=we(t,e);be(e,d),t.lineStyle=t.lineStyle||{};var u=Se(t.node1,t.node2,e),c=e.__curvenessList,p=i||d%2?0:1;if(r.isForward)return c[p+s];var h=Ie(u),g=Me(h,e),f=c[s+g+p];return n?i?o&&0===o[0]?(g+p)%2?f:-f:((g%2?0:1)+p)%2?f:-f:(g+p)%2?f:-f:c[s+g+p]}function Te(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var a=t.getGraph();a.eachNode((function(t){var e=t.getModel();t.setLayout([+e.get("x"),+e.get("y")])})),Ne(a,t)}}function Ne(t,e){t.eachEdge((function(t,a){var n=et(t.getModel().get(["lineStyle","curveness"]),-De(t,e,a,!0),0),o=at(t.node1.getLayout()),i=at(t.node2.getLayout()),r=[o,i];+n&&r.push([(o[0]+i[0])/2-(o[1]-i[1])*n,(o[1]+i[1])/2-(i[0]-o[0])*n]),t.setLayout(r)}))}function Ae(t,e){t.eachSeriesByType("graph",(function(t){var e=t.get("layout"),a=t.coordinateSystem;if(a&&"view"!==a.type){var n=t.getData(),o=[];E(a.dimensions,(function(t){o=o.concat(n.mapDimensionsAll(t))}));for(var i=0;i<n.count();i++){for(var r=[],s=!1,l=0;l<o.length;l++){var d=n.get(o[l],i);isNaN(d)||(s=!0),r.push(d)}s?n.setItemLayout(i,a.dataToPoint(r)):n.setItemLayout(i,[NaN,NaN])}Ne(n.graph,t)}else e&&"none"!==e||Te(t)}))}function Ee(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var a=t.option.nodeScaleRatio,n=e.scaleX;return((e.getZoom()-1)*a+1)/n}function Ce(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),+e}var Ve=Math.PI,Re=[];function ke(t,e,a,n){var o=t.coordinateSystem;if(!o||"view"===o.type){var i=o.getBoundingRect(),r=t.getData(),s=r.graph,l=i.width/2+i.x,d=i.height/2+i.y,u=Math.min(i.width,i.height)/2,c=r.count();if(r.setLayout({cx:l,cy:d}),c){if(a){var p=o.pointToData(n),h=p[0],g=p[1],f=[h-l,g-d];T(f,f),nt(f,f,u),a.setLayout([l+f[0],d+f[1]],!0),ze(a,t.get(["circular","rotateLabel"]),l,d)}Pe[e](t,s,r,u,l,d,c),s.eachEdge((function(e,a){var n,o=et(e.getModel().get(["lineStyle","curveness"]),De(e,t,a),0),i=at(e.node1.getLayout()),r=at(e.node2.getLayout()),s=(i[0]+r[0])/2,u=(i[1]+r[1])/2;+o&&(n=[l*(o*=3)+s*(1-o),d*o+u*(1-o)]),e.setLayout([i,r,n])}))}}}var Pe={value:function(t,e,a,n,o,i,r){var s=0,l=a.getSum("value"),d=2*Math.PI/(l||r);e.eachNode((function(t){var e=t.getValue("value"),a=d*(l?e:1)/2;s+=a,t.setLayout([n*Math.cos(s)+o,n*Math.sin(s)+i]),s+=a}))},symbolSize:function(t,e,a,n,o,i,r){var s=0;Re.length=r;var l=Ee(t);e.eachNode((function(t){var e=Ce(t);isNaN(e)&&(e=2),e<0&&(e=0),e*=l;var a=Math.asin(e/2/n);isNaN(a)&&(a=Ve/2),Re[t.dataIndex]=a,s+=2*a}));var d=(2*Ve-s)/r/2,u=0;e.eachNode((function(t){var e=d+Re[t.dataIndex];u+=e,(!t.getLayout()||!t.getLayout().fixed)&&t.setLayout([n*Math.cos(u)+o,n*Math.sin(u)+i]),u+=e}))}};function ze(t,e,a,n){var o=t.getGraphicEl();if(o){var i=t.getModel().get(["label","rotate"])||0,r=o.getSymbolPath();if(e){var s=t.getLayout(),l=Math.atan2(s[1]-n,s[0]-a);l<0&&(l=2*Math.PI+l);var d=s[0]<a;d&&(l-=Math.PI);var u=d?"left":"right";r.setTextConfig({rotation:-l,position:u,origin:"center"});var c=r.ensureState("emphasis");q(c.textConfig||(c.textConfig={}),{position:u})}else r.setTextConfig({rotation:i*=Math.PI/180})}}function Be(t){t.eachSeriesByType("graph",(function(t){"circular"===t.get("layout")&&ke(t,"symbolSize")}))}var je=st;function Ge(t){t.eachSeriesByType("graph",(function(t){var e=t.coordinateSystem;if(!e||"view"===e.type)if("force"===t.get("layout")){var a=t.preservedPoints||{},n=t.getGraph(),o=n.data,i=n.edgeData,r=t.getModel("force"),s=r.get("initLayout");t.preservedPoints?o.each((function(t){var e=o.getId(t);o.setItemLayout(t,a[e]||[NaN,NaN])})):s&&"none"!==s?"circular"===s&&ke(t,"value"):Te(t);var l=o.getDataExtent("value"),d=i.getDataExtent("value"),u=r.get("repulsion"),c=r.get("edgeLength"),p=z(u)?u:[u,u],h=z(c)?c:[c,c];h=[h[1],h[0]];var g=o.mapArray("value",(function(t,e){var a=o.getItemLayout(e),n=lt(t,l,p);return isNaN(n)&&(n=(p[0]+p[1])/2),{w:n,rep:n,fixed:o.getItemModel(e).get("fixed"),p:!a||isNaN(a[0])||isNaN(a[1])?null:a}})),f=i.mapArray("value",(function(e,a){var o=n.getEdgeByIndex(a),i=lt(e,d,h);isNaN(i)&&(i=(h[0]+h[1])/2);var r=o.getModel(),s=et(o.getModel().get(["lineStyle","curveness"]),-De(o,t,a,!0),0);return{n1:g[o.node1.dataIndex],n2:g[o.node2.dataIndex],d:i,curveness:s,ignoreForceLayout:r.get("ignoreForceLayout")}})),y=e.getBoundingRect(),m=function(t,e,a){for(var n=t,o=e,i=a.rect,r=i.width,s=i.height,l=[i.x+r/2,i.y+s/2],d=null==a.gravity?.1:a.gravity,u=0;u<n.length;u++){var c=n[u];c.p||(c.p=ot(r*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),c.pp=at(c.p),c.edges=null}var p,h,g=null==a.friction?.6:a.friction,f=g;return{warmUp:function(){f=.8*g},setFixed:function(t){n[t].fixed=!0},setUnfixed:function(t){n[t].fixed=!1},beforeStep:function(t){p=t},afterStep:function(t){h=t},step:function(t){p&&p(n,o);for(var e=[],a=n.length,i=0;i<o.length;i++){var r=o[i];if(!r.ignoreForceLayout){var s=r.n1,u=r.n2;O(e,u.p,s.p);var c=it(e)-r.d,g=u.w/(s.w+u.w);isNaN(g)&&(g=0),T(e,e),!s.fixed&&je(s.p,s.p,e,g*c*f),!u.fixed&&je(u.p,u.p,e,-(1-g)*c*f)}}for(i=0;i<a;i++)(x=n[i]).fixed||(O(e,l,x.p),je(x.p,x.p,e,d*f));for(i=0;i<a;i++){s=n[i];for(var y=i+1;y<a;y++){u=n[y],O(e,u.p,s.p),0===(c=it(e))&&(rt(e,Math.random()-.5,Math.random()-.5),c=1);var m=(s.rep+u.rep)/c/c;!s.fixed&&je(s.pp,s.pp,e,m),!u.fixed&&je(u.pp,u.pp,e,-m)}}var v=[];for(i=0;i<a;i++){var x;(x=n[i]).fixed||(O(v,x.p,x.pp),je(x.p,x.p,v,f),w(x.pp,x.p))}var _=(f*=.992)<.01;h&&h(n,o,_),t&&t(_)}}}(g,f,{rect:y,gravity:r.get("gravity"),friction:r.get("friction")});m.beforeStep((function(t,e){for(var a=0,o=t.length;a<o;a++)t[a].fixed&&w(t[a].p,n.getNodeByIndex(a).getLayout())})),m.afterStep((function(t,e,i){for(var r=0,s=t.length;r<s;r++)t[r].fixed||n.getNodeByIndex(r).setLayout(t[r].p),a[o.getId(r)]=t[r].p;for(r=0,s=e.length;r<s;r++){var l=e[r],d=n.getEdgeByIndex(r),u=l.n1.p,c=l.n2.p,p=d.getLayout();(p=p?p.slice():[])[0]=p[0]||[],p[1]=p[1]||[],w(p[0],u),w(p[1],c),+l.curveness&&(p[2]=[(u[0]+c[0])/2-(u[1]-c[1])*l.curveness,(u[1]+c[1])/2-(c[0]-u[0])*l.curveness]),d.setLayout(p)}})),t.forceLayout=m,t.preservedPoints=a,m.step()}else t.forceLayout=null}))}function Oe(t,e){var a=[];return t.eachSeriesByType("graph",(function(t){var n=t.get("coordinateSystem");if(!n||"view"===n){var o=t.getData(),i=o.mapArray((function(t){var e=o.getItemModel(t);return[+e.get("x"),+e.get("y")]})),r=[],s=[];dt(i,r,s),s[0]-r[0]==0&&(s[0]+=1,r[0]-=1),s[1]-r[1]==0&&(s[1]+=1,r[1]-=1);var l=(s[0]-r[0])/(s[1]-r[1]),d=function(t,e,a){var n=q(t.getBoxLayoutParams(),{aspect:a});return ut(n,{width:e.getWidth(),height:e.getHeight()})}(t,e,l);isNaN(l)&&(r=[d.x,d.y],s=[d.x+d.width,d.y+d.height]);var u=s[0]-r[0],c=s[1]-r[1],p=d.width,h=d.height,g=t.coordinateSystem=new Xt;g.zoomLimit=t.get("scaleLimit"),g.setBoundingRect(r[0],r[1],u,c),g.setViewRect(d.x,d.y,p,h),g.setCenter(t.get("center"),e),g.setZoom(t.get("zoom")),a.push(g)}})),a}var Fe=[],Xe=[],Ye=[],Ze=pt,Ue=ht,He=Math.abs;function We(t,e,a){for(var n,o=t[0],i=t[1],r=t[2],s=1/0,l=a*a,d=.1,u=.1;u<=.9;u+=.1){Fe[0]=Ze(o[0],i[0],r[0],u),Fe[1]=Ze(o[1],i[1],r[1],u),(h=He(Ue(Fe,e)-l))<s&&(s=h,n=u)}for(var c=0;c<32;c++){var p=n+d;Xe[0]=Ze(o[0],i[0],r[0],n),Xe[1]=Ze(o[1],i[1],r[1],n),Ye[0]=Ze(o[0],i[0],r[0],p),Ye[1]=Ze(o[1],i[1],r[1],p);var h=Ue(Xe,e)-l;if(He(h)<.01)break;var g=Ue(Ye,e)-l;d/=2,h<0?g>=0?n+=d:n-=d:g>=0?n-=d:n+=d}return n}function qe(t,e){var a=[],n=ct,o=[[],[],[]],i=[[],[]],r=[];e/=2,t.eachEdge((function(t,s){var l=t.getLayout(),d=t.getVisual("fromSymbol"),u=t.getVisual("toSymbol");l.__original||(l.__original=[at(l[0]),at(l[1])],l[2]&&l.__original.push(at(l[2])));var c=l.__original;if(null!=l[2]){if(w(o[0],c[0]),w(o[1],c[2]),w(o[2],c[1]),d&&"none"!==d){var p=Ce(t.node1),h=We(o,c[0],p*e);n(o[0][0],o[1][0],o[2][0],h,a),o[0][0]=a[3],o[1][0]=a[4],n(o[0][1],o[1][1],o[2][1],h,a),o[0][1]=a[3],o[1][1]=a[4]}if(u&&"none"!==u){p=Ce(t.node2),h=We(o,c[1],p*e);n(o[0][0],o[1][0],o[2][0],h,a),o[1][0]=a[1],o[2][0]=a[2],n(o[0][1],o[1][1],o[2][1],h,a),o[1][1]=a[1],o[2][1]=a[2]}w(l[0],o[0]),w(l[1],o[2]),w(l[2],o[1])}else{if(w(i[0],c[0]),w(i[1],c[1]),O(r,i[1],i[0]),T(r,r),d&&"none"!==d){p=Ce(t.node1);st(i[0],i[0],r,p*e)}if(u&&"none"!==u){p=Ce(t.node2);st(i[1],i[1],r,-p*e)}w(l[0],i[0]),w(l[1],i[1])}}))}function Ke(t){return"view"===t.type}const Je=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a}return m(e,t),e.prototype.init=function(t,e){var a=new gt,n=new ie,o=this.group;this._controller=new ft(e.getZr()),this._controllerHost={target:o},o.add(a.group),o.add(n.group),this._symbolDraw=a,this._lineDraw=n,this._firstRender=!0},e.prototype.render=function(t,e,a){var n=this,o=t.coordinateSystem;this._model=t;var i=this._symbolDraw,r=this._lineDraw,s=this.group;if(Ke(o)){var l={x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY};this._firstRender?s.attr(l):C(s,l,t)}qe(t.getGraph(),Ee(t));var d=t.getData();i.updateData(d);var u=t.getEdgeData();r.updateData(u),this._updateNodeAndLinkScale(),this._updateController(t,e,a),clearTimeout(this._layoutTimeout);var c=t.forceLayout,p=t.get(["force","layoutAnimation"]);c&&this._startForceLayoutIteration(c,p);var h=t.get("layout");d.graph.eachNode((function(e){var a=e.dataIndex,o=e.getGraphicEl(),i=e.getModel();if(o){o.off("drag").off("dragend");var r=i.get("draggable");r&&o.on("drag",(function(i){switch(h){case"force":c.warmUp(),!n._layouting&&n._startForceLayoutIteration(c,p),c.setFixed(a),d.setItemLayout(a,[o.x,o.y]);break;case"circular":d.setItemLayout(a,[o.x,o.y]),e.setLayout({fixed:!0},!0),ke(t,"symbolSize",e,[i.offsetX,i.offsetY]),n.updateLayout(t);break;default:d.setItemLayout(a,[o.x,o.y]),Ne(t.getGraph(),t),n.updateLayout(t)}})).on("dragend",(function(){c&&c.setUnfixed(a)})),o.setDraggable(r,!!i.get("cursor")),"adjacency"===i.get(["emphasis","focus"])&&(yt(o).focus=e.getAdjacentDataIndices())}})),d.graph.eachEdge((function(t){var e=t.getGraphicEl(),a=t.getModel().get(["emphasis","focus"]);e&&"adjacency"===a&&(yt(e).focus={edge:[t.dataIndex],node:[t.node1.dataIndex,t.node2.dataIndex]})}));var g="circular"===t.get("layout")&&t.get(["circular","rotateLabel"]),f=d.getLayout("cx"),y=d.getLayout("cy");d.graph.eachNode((function(t){ze(t,g,f,y)})),this._firstRender=!1},e.prototype.dispose=function(){this.remove(),this._controller&&this._controller.dispose(),this._controllerHost=null},e.prototype._startForceLayoutIteration=function(t,e){var a=this;!function n(){t.step((function(t){a.updateLayout(a._model),(a._layouting=!t)&&(e?a._layoutTimeout=setTimeout(n,16):n())}))}()},e.prototype._updateController=function(t,e,a){var n=this,o=this._controller,i=this._controllerHost,r=this.group;o.setPointerChecker((function(e,n,o){var i=r.getBoundingRect();return i.applyTransform(r.transform),i.contain(n,o)&&!mt(e,a,t)})),Ke(t.coordinateSystem)?(o.enable(t.get("roam")),i.zoomLimit=t.get("scaleLimit"),i.zoom=t.coordinateSystem.getZoom(),o.off("pan").off("zoom").on("pan",(function(e){!function(t,e,a){var n=t.target;n.x+=e,n.y+=a,n.dirty()}(i,e.dx,e.dy),a.dispatchAction({seriesId:t.id,type:"graphRoam",dx:e.dx,dy:e.dy})})).on("zoom",(function(e){!function(t,e,a,n){var o=t.target,i=t.zoomLimit,r=t.zoom=t.zoom||1;if(r*=e,i){var s=i.min||0,l=i.max||1/0;r=Math.max(Math.min(l,r),s)}var d=r/t.zoom;t.zoom=r,o.x-=(a-o.x)*(d-1),o.y-=(n-o.y)*(d-1),o.scaleX*=d,o.scaleY*=d,o.dirty()}(i,e.scale,e.originX,e.originY),a.dispatchAction({seriesId:t.id,type:"graphRoam",zoom:e.scale,originX:e.originX,originY:e.originY}),n._updateNodeAndLinkScale(),qe(t.getGraph(),Ee(t)),n._lineDraw.updateLayout(),a.updateLabelLayout()}))):o.disable()},e.prototype._updateNodeAndLinkScale=function(){var t=this._model,e=t.getData(),a=Ee(t);e.eachItemGraphicEl((function(t,e){t&&t.setSymbolScale(a)}))},e.prototype.updateLayout=function(t){qe(t.getGraph(),Ee(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},e.prototype.remove=function(){clearTimeout(this._layoutTimeout),this._layouting=!1,this._layoutTimeout=null,this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},e.type="graph",e}(vt);function $e(t){return"_EC_"+t}var Qe=function(){function t(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return t.prototype.isDirected=function(){return this._directed},t.prototype.addNode=function(t,e){t=null==t?""+e:""+t;var a=this._nodesMap;if(!a[$e(t)]){var n=new ta(t,e);return n.hostGraph=this,this.nodes.push(n),a[$e(t)]=n,n}},t.prototype.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},t.prototype.getNodeById=function(t){return this._nodesMap[$e(t)]},t.prototype.addEdge=function(t,e,a){var n=this._nodesMap,o=this._edgesMap;if(Q(t)&&(t=this.nodes[t]),Q(e)&&(e=this.nodes[e]),t instanceof ta||(t=n[$e(t)]),e instanceof ta||(e=n[$e(e)]),t&&e){var i=t.id+"-"+e.id,r=new ea(t,e,a);return r.hostGraph=this,this._directed&&(t.outEdges.push(r),e.inEdges.push(r)),t.edges.push(r),t!==e&&e.edges.push(r),this.edges.push(r),o[i]=r,r}},t.prototype.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},t.prototype.getEdge=function(t,e){t instanceof ta&&(t=t.id),e instanceof ta&&(e=e.id);var a=this._edgesMap;return this._directed?a[t+"-"+e]:a[t+"-"+e]||a[e+"-"+t]},t.prototype.eachNode=function(t,e){for(var a=this.nodes,n=a.length,o=0;o<n;o++)a[o].dataIndex>=0&&t.call(e,a[o],o)},t.prototype.eachEdge=function(t,e){for(var a=this.edges,n=a.length,o=0;o<n;o++)a[o].dataIndex>=0&&a[o].node1.dataIndex>=0&&a[o].node2.dataIndex>=0&&t.call(e,a[o],o)},t.prototype.breadthFirstTraverse=function(t,e,a,n){if(e instanceof ta||(e=this._nodesMap[$e(e)]),e){for(var o="out"===a?"outEdges":"in"===a?"inEdges":"edges",i=0;i<this.nodes.length;i++)this.nodes[i].__visited=!1;if(!t.call(n,e,null))for(var r=[e];r.length;){var s=r.shift(),l=s[o];for(i=0;i<l.length;i++){var d=l[i],u=d.node1===s?d.node2:d.node1;if(!u.__visited){if(t.call(n,u,s))return;r.push(u),u.__visited=!0}}}}},t.prototype.update=function(){for(var t=this.data,e=this.edgeData,a=this.nodes,n=this.edges,o=0,i=a.length;o<i;o++)a[o].dataIndex=-1;for(o=0,i=t.count();o<i;o++)a[t.getRawIndex(o)].dataIndex=o;e.filterSelf((function(t){var a=n[e.getRawIndex(t)];return a.node1.dataIndex>=0&&a.node2.dataIndex>=0}));for(o=0,i=n.length;o<i;o++)n[o].dataIndex=-1;for(o=0,i=e.count();o<i;o++)n[e.getRawIndex(o)].dataIndex=o},t.prototype.clone=function(){for(var e=new t(this._directed),a=this.nodes,n=this.edges,o=0;o<a.length;o++)e.addNode(a[o].id,a[o].dataIndex);for(o=0;o<n.length;o++){var i=n[o];e.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return e},t}(),ta=function(){function t(t,e){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=null==t?"":t,this.dataIndex=null==e?-1:e}return t.prototype.degree=function(){return this.edges.length},t.prototype.inDegree=function(){return this.inEdges.length},t.prototype.outDegree=function(){return this.outEdges.length},t.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(t)},t.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},e=0;e<this.edges.length;e++){var a=this.edges[e];a.dataIndex<0||(t.edge.push(a.dataIndex),t.node.push(a.node1.dataIndex,a.node2.dataIndex))}return t},t.prototype.getTrajectoryDataIndices=function(){for(var t=_t(),e=_t(),a=0;a<this.edges.length;a++){var n=this.edges[a];if(!(n.dataIndex<0)){t.set(n.dataIndex,!0);for(var o=[n.node1],i=[n.node2],r=0;r<o.length;){var s=o[r];r++,e.set(s.dataIndex,!0);for(var l=0;l<s.inEdges.length;l++)t.set(s.inEdges[l].dataIndex,!0),o.push(s.inEdges[l].node1)}for(r=0;r<i.length;){var d=i[r];r++,e.set(d.dataIndex,!0);for(l=0;l<d.outEdges.length;l++)t.set(d.outEdges[l].dataIndex,!0),i.push(d.outEdges[l].node2)}}}return{edge:t.keys(),node:e.keys()}},t}(),ea=function(){function t(t,e,a){this.dataIndex=-1,this.node1=t,this.node2=e,this.dataIndex=null==a?-1:a}return t.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(t)},t.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},t.prototype.getTrajectoryDataIndices=function(){var t=_t(),e=_t();t.set(this.dataIndex,!0);for(var a=[this.node1],n=[this.node2],o=0;o<a.length;){var i=a[o];o++,e.set(i.dataIndex,!0);for(var r=0;r<i.inEdges.length;r++)t.set(i.inEdges[r].dataIndex,!0),a.push(i.inEdges[r].node1)}for(o=0;o<n.length;){var s=n[o];o++,e.set(s.dataIndex,!0);for(r=0;r<s.outEdges.length;r++)t.set(s.outEdges[r].dataIndex,!0),n.push(s.outEdges[r].node2)}return{edge:t.keys(),node:e.keys()}},t}();function aa(t,e){return{getValue:function(a){var n=this[t][e];return n.getStore().get(n.getDimensionIndex(a||"value"),this.dataIndex)},setVisual:function(a,n){this.dataIndex>=0&&this[t][e].setItemVisual(this.dataIndex,a,n)},getVisual:function(a){return this[t][e].getItemVisual(this.dataIndex,a)},setLayout:function(a,n){this.dataIndex>=0&&this[t][e].setItemLayout(this.dataIndex,a,n)},getLayout:function(){return this[t][e].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[t][e].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[t][e].getRawIndex(this.dataIndex)}}}xt(ta,aa("hostGraph","data")),xt(ea,aa("hostGraph","edgeData"));const na=Qe;function oa(t,e,a,n,o){for(var i=new na(n),r=0;r<t.length;r++)i.addNode(bt(t[r].id,t[r].name,r),r);var s=[],l=[],d=0;for(r=0;r<e.length;r++){var u=e[r],c=u.source,p=u.target;i.addEdge(c,p,d)&&(l.push(u),s.push(bt(St(u.id,null),c+" > "+p)),d++)}var h,g=a.get("coordinateSystem");if("cartesian2d"===g||"polar"===g)h=It(t,a);else{var f=Lt.get(g),y=f&&f.dimensions||[];wt(y,"value")<0&&y.concat(["value"]);var m=Mt(t,{coordDimensions:y,encodeDefine:a.getEncode()}).dimensions;(h=new Dt(m,a)).initData(t)}var v,x,_,b=new Dt(["value"],a);return b.initData(l,s),o&&o(h,b),x=(v={mainData:h,struct:i,structAttr:"graph",datas:{node:h,edge:b},datasAttr:{node:"data",edge:"edgeData"}}).mainData,(_=v.datas)||(_={main:x},v.datasAttr={main:"data"}),v.datas=v.mainData=null,he(x,_,v),E(_,(function(t){E(x.TRANSFERABLE_METHODS,(function(e){t.wrapMethod(e,H(le,v))}))})),x.wrapMethod("cloneShallow",H(ue,v)),E(x.CHANGABLE_METHODS,(function(t){x.wrapMethod(t,H(de,v))})),W(_[x.dataType]===x),i.update(),i}const ia=function(t){function e(){var a=null!==t&&t.apply(this,arguments)||this;return a.type=e.type,a.hasSymbolVisual=!0,a}return m(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments);var a=this;function n(){return a._categoriesData}this.legendVisualProvider=new re(n,n),this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},e.prototype.mergeOption=function(e){t.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},e.prototype.mergeDefaultAndTheme=function(e){t.prototype.mergeDefaultAndTheme.apply(this,arguments),Tt(e,"edgeLabel",["show"])},e.prototype.getInitialData=function(t,e){var a,n=t.edges||t.links||[],o=t.data||t.nodes||[],i=this;if(o&&n){_e(a=this)&&(a.__curvenessList=[],a.__edgeMap={},be(a));var r=oa(o,n,this,!0,(function(t,e){t.wrapMethod("getItemModel",(function(t){var e=i._categoriesModels[t.getShallow("category")];return e&&(e.parentModel=t.parentModel,t.parentModel=e),t}));var a=Nt.prototype.getModel;function n(t,e){var n=a.call(this,t,e);return n.resolveParentPath=o,n}function o(t){if(t&&("label"===t[0]||"label"===t[1])){var e=t.slice();return"label"===t[0]?e[0]="edgeLabel":"label"===t[1]&&(e[1]="edgeLabel"),e}return t}e.wrapMethod("getItemModel",(function(t){return t.resolveParentPath=o,t.getModel=n,t}))}));return E(r.edges,(function(t){!function(t,e,a,n){if(_e(a)){var o=Se(t,e,a),i=a.__edgeMap,r=i[Ie(o)];i[o]&&!r?i[o].isForward=!0:r&&i[o]&&(r.isForward=!0,i[o].isForward=!1),i[o]=i[o]||[],i[o].push(n)}}(t.node1,t.node2,this,t.dataIndex)}),this),r.data}},e.prototype.getGraph=function(){return this.getData().graph},e.prototype.getEdgeData=function(){return this.getGraph().edgeData},e.prototype.getCategoriesData=function(){return this._categoriesData},e.prototype.formatTooltip=function(t,e,a){if("edge"===a){var n=this.getData(),o=this.getDataParams(t,a),i=n.graph.getEdgeByIndex(t),r=n.getName(i.node1.dataIndex),s=n.getName(i.node2.dataIndex),l=[];return null!=r&&l.push(r),null!=s&&l.push(s),At("nameValue",{name:l.join(" > "),value:o.value,noValue:null==o.value})}return Et({series:this,dataIndex:t,multipleSeries:e})},e.prototype._updateCategoriesData=function(){var t=J(this.option.categories||[],(function(t){return null!=t.value?t:q({value:0},t)})),e=new Dt(["value"],this);e.initData(t),this._categoriesData=e,this._categoriesModels=e.mapArray((function(t){return e.getItemModel(t)}))},e.prototype.setZoom=function(t){this.option.zoom=t},e.prototype.setCenter=function(t){this.option.center=t},e.prototype.isAnimationEnabled=function(){return t.prototype.isAnimationEnabled.call(this)&&!("force"===this.get("layout")&&this.get(["force","layoutAnimation"]))},e.type="series.graph",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},e}(Ct);var ra={type:"graphRoam",event:"graphRoam",update:"none"};function sa(t){t.registerChartView(Je),t.registerSeriesModel(ia),t.registerProcessor(fe),t.registerVisual(ye),t.registerVisual(ve),t.registerLayout(Ae),t.registerLayout(t.PRIORITY.VISUAL.POST_CHART_LAYOUT,Be),t.registerLayout(Ge),t.registerCoordinateSystem("graphView",{dimensions:Xt.dimensions,create:Oe}),t.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},Vt),t.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},Vt),t.registerAction(ra,(function(t,e,a){e.eachComponent({mainType:"series",query:t},(function(e){var n=function(t,e,a,n){var o=t.getZoom(),i=t.getCenter(),r=e.zoom,s=t.projectedToPoint?t.projectedToPoint(i):t.dataToPoint(i);if(null!=e.dx&&null!=e.dy&&(s[0]-=e.dx,s[1]-=e.dy,t.setCenter(Yt(t,s),n)),null!=r){if(a){var l=a.min||0,d=a.max||1/0;r=Math.max(Math.min(o*r,d),l)/o}t.scaleX*=r,t.scaleY*=r;var u=(e.originX-t.x)*(r-1),c=(e.originY-t.y)*(r-1);t.x-=u,t.y-=c,t.updateTransform(),t.setCenter(Yt(t,s),n),t.setZoom(r*o)}return{center:t.getCenter(),zoom:t.getZoom()}}(e.coordinateSystem,t,void 0,a);e.setCenter&&e.setCenter(n.center),e.setZoom&&e.setZoom(n.zoom)}))}))}const la=()=>{t.exports.useEffect((()=>{Rt([kt,Pt,sa,zt]),a()}),[]);const a=()=>{let t=[];for(let o=0;o<20;o++){t[o]=[];for(let e=0;e<20;e++)t[o][e]=o===e?1:e>o?parseFloat(Math.random().toFixed(2)):t[e][o]}let e=[],a=[];for(let o=0;o<t.length;o++){e.push({id:o,name:`${o+1}`});for(let e=o+1;e<t[o].length;e++)t[o][e]>.9&&a.push({source:o,target:e,label:{show:!0},weight:t[o][e]})}const n={title:{text:"相似度"},tooltip:{show:!0,formatter:t=>"node"===t.dataType?"选手名称：xxx<br>选手id：xxx":"edge"===t.dataType?"相似度："+t.data.weight:void 0},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",series:[{type:"graph",layout:"force",data:e,links:a,roam:!0,force:{repulsion:1e3,edgeLength:[100,200]},symbolSize:50,edgeSymbol:[],edgeSymbolSize:[4,10],label:{show:!0},edgeLabel:{normal:{show:!0,textStyle:{fontSize:12},formatter:function(t){return t.data.weight}}},lineStyle:{opacity:.9,width:4,curveness:0}}]};Bt(document.getElementById("similarity")).setOption(n)};return e("div",{id:"similarity",style:{width:"1000px",height:"800px"}})},da=()=>{const m=a.useNavTo(),v=n(g),x=n(o),[_,b]=t.exports.useState(),[S,I]=t.exports.useState(""),L=n(i),[w,M]=t.exports.useState(!1);t.exports.useEffect((()=>{v&&(D(),I(r.getDuration(v.start_time,v.end_time)))}),[v]);const D=async()=>{if(!v)return;const t=await s(v.user_id);b(t.data.data.user)},T=()=>{const t=null==v?void 0:v.start_time;p(t).valueOf()<=p().valueOf()?L&&L.error({message:"比赛进行中或已结束，无法修改"}):m(`/creation/competition/declare?competition_id=${null==v?void 0:v.id}`)};return l("div",{children:[v&&l("div",{className:"",children:[e(jt,{items:(t=>{var a,n;const o=[{key:"1",label:"标题",children:t.title},{key:"2",label:"开始时间",children:t.start_time},{key:"3",label:"结束时间",children:t.end_time},{key:"4",label:"比赛时长",children:S},{key:"5",label:"类型",children:e(f,{size:1,type:t.type})},{key:"6",label:"发起人",children:l(d,{children:[(null==_?void 0:_.name)||"",(null==_?void 0:_.name)===(null==x?void 0:x.name)&&l(u,{children:[e(c,{size:"small",type:"dashed",danger:!0,onClick:T,children:"修改比赛"}),e(c,{size:"small",type:"primary",onClick:()=>M(!0),children:"相似度查询"})]})]})}];return t.labels&&(null==(a=t.labels)?void 0:a.length)>0&&o.push({key:"7",label:"标签",children:e("span",{children:null==(n=t.labels)?void 0:n.map(((t,a)=>e("span",{children:a<=1&&e(y,{size:1,children:t.label})},a)))})}),o})(v)}),e(jt,{items:[{key:"7",label:"描述",children:e(h,{html:v.content})}]})]}),e(Gt,{width:"1000px",open:w,footer:null,onCancel:()=>M(!1),afterOpenChange:t=>{},children:e(la,{})})]})};export{da as default};

import{_ as e,t as a,bF as s,bG as i,j as t,a as l,o as r,p as d,M as o,D as c}from"./index.5c064301.js";import{a as n,b as m,l as k,c as u}from"./remark.4a43720f.js";import{R as f}from"./Readonly.a9ebc692.js";import{s as p}from"./style.module.dc2582af.js";import{C as h}from"./index.9225dd62.js";const x=x=>{var v,N;const[y,b]=e.exports.useState(x.remark),{token:j}=a.useToken();e.exports.useEffect((()=>{const e={...y};Promise.all([n(y.id),m(y.id,"true"),m(y.id,"false"),s(y.user_id)]).then((a=>{e.liked=a[0].data.data.like,e.likeNum=a[1].data.data.total,e.dislikeNum=a[2].data.data.total,e.user=a[3].data.data.user,b(e)}))}),[x.remark]);const T=e.exports.useMemo((()=>{const e=i.getTimeAgo(y.created_at);return`${e.num}${e.unit}前`}),[y]),C=e.exports.useCallback((e=>{k(y.id,e?"true":"false").then((async a=>{const{data:s}=await m(y.id);200===a.data.code&&b((a=>({...a,liked:e?1:-1,likeNum:s.data.total})))}))}),[y]),$=e.exports.useCallback((()=>{u(y.id).then((async e=>{const{data:a}=await m(y.id,"false");200===e.data.code&&b((e=>({...e,liked:0,likeNum:a.data.total})))}))}),[y]);return t(h,{className:"w-full my-4",size:"small",children:[t("div",{className:"flex items-center",children:[l(r,{className:"card-avatar",src:l("img",{src:`${d}/${null==(v=y.user)?void 0:v.icon}`})}),l("div",{className:"card-username",children:null==(N=y.user)?void 0:N.name}),l("div",{className:"card-time",children:T})]}),l(f,{html:y.content,className:"mx-9"}),t("div",{className:`${p.remarkFooter} flex items-center ml-12`,children:[t("div",{onClick:()=>{1===y.liked?$():C(!0)},children:[l(o,{href:1===y.liked?"#icon-liked":"#icon-like",size:1,color:1===y.liked?j.colorPrimaryTextHover:j.colorTextDescription}),l("span",{children:y.likeNum})]}),l(c,{type:"vertical"}),t("div",{onClick:()=>{-1===y.liked?$():C(!1)},children:[l(o,{href:-1===y.liked?"#icon-disliked":"#icon-dislike",size:1,color:-1===y.liked?j.colorPrimaryTextHover:j.colorTextDescription}),l("span",{children:y.dislikeNum})]})]})]})};export{x as R};
